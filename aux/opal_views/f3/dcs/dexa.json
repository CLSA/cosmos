{"from": ["clsa-dcs-f3.Participants","clsa-dcs-images-f3.DualHipBoneDensity","clsa-dcs-images-f3.ForearmBoneDensity","clsa-dcs-images-f3.LateralBoneDensity","clsa-dcs-images-f3.SpineBoneDensity","clsa-dcs-images-f3.WholeBodyBoneDensity"],"name": "QC_F3_dexa","datasourceName": "cosmos_dcs","Magma.VariableListViewDto.view": {"variables": [{"name": "technician","entityType": "Participant","valueType": "text","mimeType": "","isRepeatable": false,"attributes": [{"name": "script","value": "var list = ['LateralBoneDensity','WholeBodyBoneDensity','DualHipBoneDensity','ForearmBoneDensity','SpineBoneDensity']\nvar res = null\nfor(var i=0; i<list.length; i++) {\n  var str = $('clsa-dcs-images-f3.'+list[i]+':InstrumentRun.user').whenNull(\n    $group('Admin.Action.stage',list[i],'Admin.Action.user').asSequence().last()).lowerCase()\n  if(str.isNull().not().value()) {\n    var v = str.value()\n    if(0<v.length) {\n      res = newValue(v)\n      break\n    }  \n  }  \n}\nres  "}],"unit": "","index": 0,"referencedEntityType": ""},{"name": "contraindicated","entityType": "Participant","valueType": "boolean","mimeType": "","isRepeatable": false,"attributes": [{"name": "script","value": "$('cosmos_dcs.QC_F3_dexa_lateral:contraindicated').and(\n  $('cosmos_dcs.QC_F3_dexa_spine:contraindicated'),\n  $('cosmos_dcs.QC_F3_dexa_whole_body:contraindicated'),\n  $('cosmos_dcs.QC_F3_dexa_forearm:contraindicated'),\n  $('cosmos_dcs.QC_F3_dexa_hip:contraindicated'))"}],"unit": "","index": 0,"referencedEntityType": ""},{"name": "missing","entityType": "Participant","valueType": "boolean","mimeType": "","isRepeatable": false,"attributes": [{"name": "script","value": "$this('contraindicated').not().and($this('file_complete').eq(0))"}],"unit": "","index": 0,"referencedEntityType": ""},{"name": "duration","entityType": "Participant","valueType": "integer","mimeType": "","isRepeatable": false,"attributes": [{"name": "script","value": "$('cosmos_dcs.QC_F3_meta:group_duration_dexa')"}],"unit": "","index": 0,"referencedEntityType": ""},{"name": "file_size","entityType": "Participant","valueType": "text","mimeType": "","isRepeatable": false,"attributes": [{"name": "script","value": "var res = null\nvar list = ['hip_left','hip_right','whole_body','spine','lateral','forearm']\nvar sz = $this('file_meta')\nvar str = []  \nfor(var i = 0; i < list.length; i++) {\n  var v = sz.valueAt(i)\n  if(v.isNull().value()) continue\n  str.push('\"' + list[i] + '\":' + v.value())\n}\nif(0<str.length) {\n  res = newValue('{'+str.join(',')+'}','text')\n}\nres"}],"unit": "","index": 0,"referencedEntityType": ""},{"name": "file_complete","entityType": "Participant","valueType": "decimal","mimeType": "","isRepeatable": false,"attributes": [{"name": "script","value": "var c = newSequence([\n  $('cosmos_dcs.QC_F3_dexa_hip:contraindicated'),\n  $('cosmos_dcs.QC_F3_dexa_hip:contraindicated'),\n  $('cosmos_dcs.QC_F3_dexa_whole_body:contraindicated'),\n  $('cosmos_dcs.QC_F3_dexa_spine:contraindicated'),\n  $('cosmos_dcs.QC_F3_dexa_lateral:contraindicated'),\n  $('cosmos_dcs.QC_F3_dexa_forearm:contraindicated')\n  ], 'boolean')\n  \nvar sz = newSequence([\n  $('cosmos_dcs.QC_F3_dexa_hip:file_meta').valueAt(0),\n  $('cosmos_dcs.QC_F3_dexa_hip:file_meta').valueAt(1),\n  $('clsa-dcs-images-f3.WholeBodyBoneDensity:RES_WB_DICOM_1').length(),\n  $('clsa-dcs-images-f3.SpineBoneDensity:RES_SP_DICOM').length(),\n  $('clsa-dcs-images-f3.LateralBoneDensity:RES_SEL_DICOM_MEASURE').length(),\n  $('clsa-dcs-images-f3.ForearmBoneDensity:RES_FA_DICOM').asSequence().last().length()\n  ], 'integer').filter(function(v,i){ return c.valueAt(i).not()})\n  \nsz.trimmer().size().div(sz.size()).multiply(100).whenNull(0) "}],"unit": "","index": 0,"referencedEntityType": ""},{"name": "file_meta","entityType": "Participant","valueType": "integer","mimeType": "","isRepeatable": true,"occurrenceGroup": "","attributes": [{"name": "script","value": "newSequence([\n  $('cosmos_dcs.QC_F3_dexa_hip:file_meta').valueAt(0),\n  $('cosmos_dcs.QC_F3_dexa_hip:file_meta').valueAt(1),\n  $('clsa-dcs-images-f3.WholeBodyBoneDensity:RES_WB_DICOM_1').length(),\n  $('clsa-dcs-images-f3.SpineBoneDensity:RES_SP_DICOM').length(),  \n  $('clsa-dcs-images-f3.LateralBoneDensity:RES_SEL_DICOM_MEASURE').length(),\n  $('clsa-dcs-images-f3.ForearmBoneDensity:RES_FA_DICOM').asSequence().last().length()\n  ], 'integer')"}],"unit": "","index": 0,"referencedEntityType": ""}]}}