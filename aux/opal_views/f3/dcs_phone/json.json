{"from": ["clsa-dcs-f3.Participants"],"name": "QC_F3_json","datasourceName": "cosmos_dcs_phone","where": "$('clsa-dcs-f3.Participants:DCS_PHONE')","Magma.VariableListViewDto.view": {"variables": [{"name": "data","entityType": "Participant","valueType": "text","mimeType": "","isRepeatable": false,"attributes": [{"name": "script","value": "var prj = 'cosmos_dcs_phone.QC_F3_'\nvar qnaire_arr = ['technician','contraindicated','comment','duration','missing','qnaire_complete','skip','module_duration']\n\nvar view_list = {}\nview_list['interview']=\n    ['barcode','start_date','site','duration','stage_duration','type']\nview_list['contraindication_qnaire']=qnaire_arr\nview_list['disease_qnaire']=qnaire_arr\nview_list['general_health']=qnaire_arr\nview_list['social_network']=qnaire_arr\nview_list['os']=qnaire_arr\nview_list['height_weight']=['technician','contraindicated','comment','duration','missing','skip','height_change']\n\nvar inter_str = null\nvar stage_str = []\nfor( var key in view_list ) {  \n  var var_str = prj + key + ':'\n  var var_arr = view_list[key]  \n  key_str = []\n  for(var i=0;i<var_arr.length;i++) {\n    var var_i = var_arr[i]\n    var v = $(var_str + var_i)\n    if(v.isNull().value()) continue;    \n    if('module_duration'==var_i) {  \n      key_str.push('\"' + var_i + '\":' + v.value())\n    } else {\n      if(v.type().eq('text').and('comment'!=var_i).value()) {\n        key_str.push('\"' + var_i + '\":\"' + v.value() + '\"')\n      } else {\n        key_str.push('\"' + var_i + '\":' + v.value())\n      }  \n    }\n  }\n  if('interview'==key) {\n    inter_str = '{' + key_str.join(',') + ',\"stages\":{'\n  } else {\n    stage_str.push( '\"' + key + '\":{' + key_str.join(',') + '}')\n  }    \n}\n\nnewValue( inter_str + stage_str.join(',') +'}}','text')"},{"name": "derivedFrom","value": "/datasource/cosmos_dcs_phone/table/QC_F2_json/variable/data","namespace": "opal"}],"unit": "","index": 0,"referencedEntityType": ""}]}}